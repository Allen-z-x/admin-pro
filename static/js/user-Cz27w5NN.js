import{d as R,P as I,r as g,R as T,o as D,c as N,n as C,a as o,w as t,b as r,v as O,F as b,U as $,W as j,Z as W,f as d,S as A,T as H,$ as M,z as v,a0 as P,H as E,e as Z,g as _,V as q,t as G,y as J}from"./vendor-D0oV6N-p.js";import{c as K}from"./common-DRkHVigx.js";import{g as Q}from"./shared/role/user-BN2S2Pb5.js";const X={class:"dialog-footer"},Y=R({__name:"index",setup(ee){const n=I({nickName:"",role:0});let c=g([]),u=g([]);const i=g(!1);let s=I({id:0,nickName:"",role:[],userName:""});const L=()=>{let a=[];n.nickName||n.role?(n.nickName&&(a=u.value.filter(e=>e.nickName.indexOf(n.nickName)!==-1)),n.role&&(a=n.nickName?a:u.value,a=a.filter(e=>e.role.find(m=>m.role===n.role)))):a=u.value,u.value=a};T([()=>n.nickName,()=>n.role],()=>{(n.nickName===""||n.role===0)&&w()});const h=a=>{i.value=!0,Object.assign(s,{...a,role:a.role.map(e=>e.role)})},B=()=>{console.log(s),i.value=!1;let a=u.value.find(e=>e.id===s.id);a.nickName=s.nickName,a.role=[],console.log(a),c.value.forEach(e=>{s.role.find(m=>m===e.roleId)&&a.role.push({role:e.roleId,roleName:e.roleName})})};D(()=>{w(),S()});const w=()=>{K().then(a=>{u.value=a.data})},S=()=>{Q().then(a=>{c.value=a.data})};return(a,e)=>{const m=H,p=A,V=P,U=M,f=Z,x=$,k=q,z=j,F=W;return d(),N(b,null,[C("div",null,[o(x,{inline:!0,class:"search-form",model:r(n)},{default:t(()=>[o(p,{label:"用户名称"},{default:t(()=>[o(m,{modelValue:r(n).nickName,"onUpdate:modelValue":e[0]||(e[0]=l=>r(n).nickName=l),placeholder:"请输入用户名称"},null,8,["modelValue"])]),_:1}),o(p,{label:"用户角色"},{default:t(()=>[o(U,{modelValue:r(n).role,"onUpdate:modelValue":e[1]||(e[1]=l=>r(n).role=l),style:{width:"120px"}},{default:t(()=>[(d(),v(V,{key:0,label:"全部",value:0})),(d(!0),N(b,null,E(r(c),l=>(d(),v(V,{key:l.roleId,label:l.roleName,value:l.roleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(p,null,{default:t(()=>[o(f,{type:"primary",onClick:L},{default:t(()=>e[6]||(e[6]=[_("查询")])),_:1,__:[6]})]),_:1})]),_:1},8,["model"]),o(z,{data:r(u),border:"",style:{width:"100%"}},{default:t(()=>[o(k,{prop:"id",label:"编号",width:"180"}),o(k,{prop:"nickName",label:"用户昵称",width:"180"}),o(k,{prop:"role",label:"用户角色"},{default:t(l=>[(d(!0),N(b,null,E(l.row.role,y=>(d(),v(f,{key:y.role,link:"",type:"primary",size:"small"},{default:t(()=>[_(G(y.roleName),1)]),_:2},1024))),128))]),_:1}),o(k,{prop:"role",label:"操作"},{default:t(l=>[o(f,{link:"",type:"primary",size:"small",onClick:y=>h(l.row)},{default:t(()=>e[7]||(e[7]=[_("编辑")])),_:2,__:[7]},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),o(F,{modelValue:r(i),"onUpdate:modelValue":e[5]||(e[5]=l=>O(i)?i.value=l:null),title:"编辑用户信息"},{footer:t(()=>[C("span",X,[o(f,{onClick:e[4]||(e[4]=l=>i.value=!1)},{default:t(()=>e[8]||(e[8]=[_("取消")])),_:1,__:[8]}),o(f,{type:"primary",onClick:B},{default:t(()=>e[9]||(e[9]=[_("修改")])),_:1,__:[9]})])]),default:t(()=>[o(x,{model:r(s)},{default:t(()=>[o(p,{label:"用户昵称","label-width":"120px"},{default:t(()=>[o(m,{modelValue:r(s).nickName,"onUpdate:modelValue":e[2]||(e[2]=l=>r(s).nickName=l),class:"w192",autocomplete:"off"},null,8,["modelValue"])]),_:1}),o(p,{label:"用户角色","label-width":"120px"},{default:t(()=>[o(U,{modelValue:r(s).role,"onUpdate:modelValue":e[3]||(e[3]=l=>r(s).role=l),multiple:"",class:"m-2",size:"large",placeholder:"请选择角色"},{default:t(()=>[(d(!0),N(b,null,E(r(c),l=>(d(),v(V,{key:l.roleId,label:l.roleName,value:l.roleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}}}),te=J(Y,[["__scopeId","data-v-a1ad3f41"]]);export{te as default};
